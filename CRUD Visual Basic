Imports MySql.Data.MySqlClient
Public Class Form1
    Sub isiGrid()
        Call bukaDB()
        DA = New MySqlDataAdapter("select * from tabel_barang", Conn)
        DS = New DataSet
        DA.Fill(DS, "tabel_barang")
        DataGridView1.DataSource = DS.Tables("tabel_barang")
        DataGridView1.ReadOnly = True
    End Sub
    Sub Bersih()
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
    End Sub
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Call isiGrid()
        Call bukaDB()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        If Button1.Text = "Tambah" Then
            Button1.Text = "Simpan"
            TextBox1.Focus()
        Else
            Try
                Call bukaDB()
                DC = New MySqlCommand("SELECT Kode_Barang from tabel_barang WHERE Kode_Barang = '" & TextBox1.Text & "'", Conn)
                DR = DC.ExecuteReader
                DR.Read()
                If DR.HasRows Then
                    MsgBox("Maaf, Data dengan kode tersebut telah ada", MsgBoxStyle.Exclamation, "Peringatan")
                Else
                    Call bukaDB()
                    Dim simpan As String
                    simpan = "INSERT INTO tabel_barang (Kode_Barang,Nama_Barang,Harga_Barang,Stock_Barang) VALUES ('" & TextBox1.Text & "','" & TextBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "')"
                    DC = Conn.CreateCommand
                    With DC
                        .CommandText = simpan
                        .Connection = Conn
                        .Parameters.Add("p1", MySqlDbType.String, 4).Value = TextBox1.Text
                        .Parameters.Add("p2", MySqlDbType.String, 30).Value = TextBox2.Text
                        .Parameters.Add("p3", MySqlDbType.Int32, 8).Value = TextBox3.Text
                        .Parameters.Add("p4", MySqlDbType.Int32, 4).Value = TextBox4.Text
                        .ExecuteNonQuery()
                    End With
                    Call isiGrid()
                    Call Bersih()
                End If
            Catch ex As Exception
                MsgBox(ex.ToString, MsgBoxStyle.Critical, "Terjadi Kesalahan")
            End Try
        End If
    End Sub

    Private Sub DataGridView1_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView1.CellContentClick

    End Sub
End Class
